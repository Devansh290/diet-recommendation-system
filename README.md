# Diet-Recommendation-System
Nutrition-based Recipe Recommendation System using Content-Based Filtering
# üçΩÔ∏è Diet & Recipe Recommendation System

*A Nutrition-Based Content Filtering Project (Recommendation Systems Course)*

---

## üéØ Overview

This project implements a **content-based recommendation system** that suggests recipes according to their **nutritional composition**. It supports two primary use-cases:

* **Similar-recipe recommendations** (e.g., ‚ÄúFind recipes like *Keto Cheesecake*‚Äù)
* **Goal-based recommendations** (e.g., ‚ÄúHigh protein, low carb, under 600 kcal‚Äù)

Recipes are represented as nutrient vectors built from **Protein%**, **Carbs%**, **Fat%**, and **log(kcal)**. Recommendations are generated by **cosine similarity** in this feature space, producing interpretable results with explicit macro percentages and calories.

---

## üß† Objectives

* Build a **content-based recommender** for recipes using nutrition features
* Clean, standardize, and deduplicate multiple diet CSV files
* Engineer **macro-ratio features** and a calorie-robust signal (`log(kcal)`)
* Provide **two RS modes**: recipe-similarity and goal-based retrieval
* Keep recommendations **interpretable** (show kcal and macro %)

---

## üìÇ Dataset

Six CSV files (recipes across popular diet styles):

| File                | Description          |
| ------------------- | -------------------- |
| `All_Diets.csv`     | Combined recipe dump |
| `dash.csv`          | DASH diet            |
| `keto.csv`          | Ketogenic diet       |
| `mediterranean.csv` | Mediterranean diet   |
| `paleo.csv`         | Paleo diet           |
| `vegan.csv`         | Vegan diet           |

**Size:** ~15,612 rows before cleaning ‚Üí **7,126** unique recipes after deduplication.
**Schema (canonicalized):**
`Diet_type, Recipe_name, Cuisine_type, Protein(g), Carbs(g), Fat(g), Extraction_day, Extraction_time`

---

## üßπ Data Preprocessing

1. **Header normalization** (case/spacing/variants ‚Üí canonical names)
2. **Numeric coercion** (`Protein/Carbs/Fat` to `float`; strip units like ‚Äúg‚Äù)
3. **Deduplication** by `(Diet_type, Recipe_name)` with canonical text cleaning
4. **Sanity checks** (null counts, dtype checks) ‚Äî final table has **no nulls** in key columns
5. **Outlier scan** (IQR and P99 inspection for grams and macro %)

**Final clean table:** 7,126 rows √ó 9 columns

---

## ‚öôÔ∏è Feature Engineering

For each recipe:

* **Calories:** `kcal = 4*Protein(g) + 4*Carbs(g) + 9*Fat(g)`
* **Macro composition (% of kcal):** `Protein%`, `Carbs%`, `Fat%`
* **Calorie stabilization:** `log(kcal)` to handle heavy tails
* **Vectorization & scaling:**

  * `VectorAssembler([Protein%, Carbs%, Fat%, log(kcal)])`
  * `StandardScaler(withMean=True, withStd=True)`
  * `Normalizer(p=2)` ‚Üí **unit vectors** suitable for cosine similarity

---

## ü§ñ Recommendation Models

### 1) Content-Based Similarity (Recipe ‚Üí Recipes)

**Input:** a seed recipe name (partial match allowed)
**Process:** compute cosine similarity between the seed vector and all others
**Output:** Top-K most nutritionally similar recipes (optionally filtered by diet/cuisine)

**Example (abbrev):**
Keto Cheesecake ‚Üí {Keto No-Bake Orange Creamsicle Cheesecake, Keto Lemon Poppyseed Cheesecake, ‚Ä¶}

---

### 2) Goal-Based Retrieval (Goal ‚Üí Recipes)

**Input:** thresholds/targets (e.g., `min_protein_pct=30`, `max_carb_pct=25`, `max_kcal=600`)
**Process:** build a **target vector** from the goal; rank all recipes by cosine similarity to the goal
**Output:** Top-K recipes meeting constraints and closest to the target macro balance

**Example (abbrev):**
Goal: *High protein, low carb, <600 kcal* ‚Üí
{Paleo Steak and Veggies (268 kcal, 36.5/19.7/43.9), DASH Chop-Chop Beef Stir-Fry (438 kcal, 31.6/23.0/45.4), ‚Ä¶}

---

## üß™ Example Usage (notebook cells)

```python
# Find recipes similar to "Keto Cheesecake"
demo1 = recommend_by_recipe("Keto Cheesecake", top_k=10)

# Goal-based: high protein, low carb, under 600 kcal
demo2 = recommend_by_goal(min_protein_pct=30, max_carb_pct=25, max_kcal=600, top_k=10)

# Preset categories (internally map to sensible thresholds)
goal_query("weight_loss", top_k=10)
goal_query("muscle_gain", top_k=10)
```

---

## üìä Summary Statistics (sample from EDA)

| Diet          | Avg Protein (g) | Avg Carbs (g) | Avg Fat (g) | Protein% | Carbs% | Fat% |
| ------------- | --------------: | ------------: | ----------: | -------: | -----: | ---: |
| DASH          |              69 |           160 |         100 |      21% |    49% |  30% |
| Keto          |             101 |            58 |         152 |      32% |    19% |  49% |
| Mediterranean |             103 |           154 |         105 |      28% |    42% |  29% |
| Paleo         |              89 |           128 |         135 |      25% |    36% |  38% |
| Vegan         |              57 |           254 |         103 |      14% |    61% |  25% |

*Interpretation:* Diet styles cluster as expected (e.g., Keto is high-fat, Vegan trends high-carb), validating the **feature space** for content-based RS.

---

## üß∞ Tech Stack

* **Language:** Python 3.12
* **Environment:** Google Colab (notebook)
* **Libraries:** `pandas`, `numpy`, `matplotlib`, `seaborn`, `pyspark` (vectorization, scaling, cosine), and light `sklearn` interop via PySpark ML components

---

## üöÄ How to Run

1. Open **Google Colab** and upload the notebook: `Diet_Recommendation_System.ipynb`
2. Upload the six CSVs (same folder/session)
3. Run cells in order (data load ‚Üí preprocessing ‚Üí features ‚Üí recommenders)
4. Use the functions shown in **Example Usage** to generate recommendations

---



## üîé Limitations

* Pure **content-based**: no user ratings or collaborative signals
* Assumes nutrition labels are reliable; serving sizes not standardized
* No ingredient-level NLP or allergen constraints yet

---

## üß≠ Future Enhancements

* Add **collaborative filtering** to build a hybrid RS
* Ingredient embeddings with **NLP** to capture flavor/technique similarity
* Personalization (user profiles, feedback loops, exploration-exploitation)
* Portion-aware kcal and **micronutrients** for health-specific goals

---

## üë§ Author

**Devansh Gohar**
4th Year B.Tech ‚Äî Artificial Intelligence & Data Science
SVKM‚Äôs NMIMS, Indore

---

## üèÅ License
This project is free and open-source under the **MIT License**.  
You are free to use, modify, and share it for educational and personal purposes.
